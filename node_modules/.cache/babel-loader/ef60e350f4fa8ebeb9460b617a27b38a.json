{"ast":null,"code":"/*\r\n This file is part of web3.js.\r\n\r\n web3.js is free software: you can redistribute it and/or modify\r\n it under the terms of the GNU Lesser General Public License as published by\r\n the Free Software Foundation, either version 3 of the License, or\r\n (at your option) any later version.\r\n\r\n web3.js is distributed in the hope that it will be useful,\r\n but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n GNU Lesser General Public License for more details.\r\n\r\n You should have received a copy of the GNU Lesser General Public License\r\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\r\n */\n\n/**\r\n * @file soliditySha3.js\r\n * @author Fabian Vogelsteller <fabian@ethereum.org>\r\n * @date 2017\r\n */\nvar BN = require('bn.js');\n\nvar utils = require('./utils.js');\n\nvar _elementaryName = function (name) {\n  /*jshint maxcomplexity:false */\n  if (name.startsWith('int[')) {\n    return 'int256' + name.slice(3);\n  } else if (name === 'int') {\n    return 'int256';\n  } else if (name.startsWith('uint[')) {\n    return 'uint256' + name.slice(4);\n  } else if (name === 'uint') {\n    return 'uint256';\n  } else if (name.startsWith('fixed[')) {\n    return 'fixed128x128' + name.slice(5);\n  } else if (name === 'fixed') {\n    return 'fixed128x128';\n  } else if (name.startsWith('ufixed[')) {\n    return 'ufixed128x128' + name.slice(6);\n  } else if (name === 'ufixed') {\n    return 'ufixed128x128';\n  }\n\n  return name;\n}; // Parse N from type<N>\n\n\nvar _parseTypeN = function (type) {\n  var typesize = /^\\D+(\\d+).*$/.exec(type);\n  return typesize ? parseInt(typesize[1], 10) : null;\n}; // Parse N from type[<N>]\n\n\nvar _parseTypeNArray = function (type) {\n  var arraySize = /^\\D+\\d*\\[(\\d+)\\]$/.exec(type);\n  return arraySize ? parseInt(arraySize[1], 10) : null;\n};\n\nvar _parseNumber = function (arg) {\n  var type = typeof arg;\n\n  if (type === 'string') {\n    if (utils.isHexStrict(arg)) {\n      return new BN(arg.replace(/0x/i, ''), 16);\n    } else {\n      return new BN(arg, 10);\n    }\n  } else if (type === 'number') {\n    return new BN(arg);\n  } else if (utils.isBigNumber(arg)) {\n    return new BN(arg.toString(10));\n  } else if (utils.isBN(arg)) {\n    return arg;\n  } else {\n    throw new Error(arg + ' is not a number');\n  }\n};\n\nvar _solidityPack = function (type, value, arraySize) {\n  /*jshint maxcomplexity:false */\n  var size, num;\n  type = _elementaryName(type);\n\n  if (type === 'bytes') {\n    if (value.replace(/^0x/i, '').length % 2 !== 0) {\n      throw new Error('Invalid bytes characters ' + value.length);\n    }\n\n    return value;\n  } else if (type === 'string') {\n    return utils.utf8ToHex(value);\n  } else if (type === 'bool') {\n    return value ? '01' : '00';\n  } else if (type.startsWith('address')) {\n    if (arraySize) {\n      size = 64;\n    } else {\n      size = 40;\n    }\n\n    if (!utils.isAddress(value)) {\n      throw new Error(value + ' is not a valid address, or the checksum is invalid.');\n    }\n\n    return utils.leftPad(value.toLowerCase(), size);\n  }\n\n  size = _parseTypeN(type);\n\n  if (type.startsWith('bytes')) {\n    if (!size) {\n      throw new Error('bytes[] not yet supported in solidity');\n    } // must be 32 byte slices when in an array\n\n\n    if (arraySize) {\n      size = 32;\n    }\n\n    if (size < 1 || size > 32 || size < value.replace(/^0x/i, '').length / 2) {\n      throw new Error('Invalid bytes' + size + ' for ' + value);\n    }\n\n    return utils.rightPad(value, size * 2);\n  } else if (type.startsWith('uint')) {\n    if (size % 8 || size < 8 || size > 256) {\n      throw new Error('Invalid uint' + size + ' size');\n    }\n\n    num = _parseNumber(value);\n\n    if (num.bitLength() > size) {\n      throw new Error('Supplied uint exceeds width: ' + size + ' vs ' + num.bitLength());\n    }\n\n    if (num.lt(new BN(0))) {\n      throw new Error('Supplied uint ' + num.toString() + ' is negative');\n    }\n\n    return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\n  } else if (type.startsWith('int')) {\n    if (size % 8 || size < 8 || size > 256) {\n      throw new Error('Invalid int' + size + ' size');\n    }\n\n    num = _parseNumber(value);\n\n    if (num.bitLength() > size) {\n      throw new Error('Supplied int exceeds width: ' + size + ' vs ' + num.bitLength());\n    }\n\n    if (num.lt(new BN(0))) {\n      return num.toTwos(size).toString('hex');\n    } else {\n      return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\n    }\n  } else {\n    // FIXME: support all other types\n    throw new Error('Unsupported or invalid type: ' + type);\n  }\n};\n\nvar _processSolidityEncodePackedArgs = function (arg) {\n  /*jshint maxcomplexity:false */\n  if (Array.isArray(arg)) {\n    throw new Error('Autodetection of array types is not supported.');\n  }\n\n  var type,\n      value = '';\n  var hexArg, arraySize; // if type is given\n\n  if (!!arg && typeof arg === 'object' && (arg.hasOwnProperty('v') || arg.hasOwnProperty('t') || arg.hasOwnProperty('value') || arg.hasOwnProperty('type'))) {\n    type = arg.hasOwnProperty('t') ? arg.t : arg.type;\n    value = arg.hasOwnProperty('v') ? arg.v : arg.value; // otherwise try to guess the type\n  } else {\n    type = utils.toHex(arg, true);\n    value = utils.toHex(arg);\n\n    if (!type.startsWith('int') && !type.startsWith('uint')) {\n      type = 'bytes';\n    }\n  }\n\n  if ((type.startsWith('int') || type.startsWith('uint')) && typeof value === 'string' && !/^(-)?0x/i.test(value)) {\n    value = new BN(value);\n  } // get the array size\n\n\n  if (Array.isArray(value)) {\n    arraySize = _parseTypeNArray(type);\n\n    if (arraySize && value.length !== arraySize) {\n      throw new Error(type + ' is not matching the given array ' + JSON.stringify(value));\n    } else {\n      arraySize = value.length;\n    }\n  }\n\n  if (Array.isArray(value)) {\n    hexArg = value.map(function (val) {\n      return _solidityPack(type, val, arraySize).toString('hex').replace('0x', '');\n    });\n    return hexArg.join('');\n  } else {\n    hexArg = _solidityPack(type, value, arraySize);\n    return hexArg.toString('hex').replace('0x', '');\n  }\n};\n/**\r\n * Hashes solidity values to a sha3 hash using keccak 256\r\n *\r\n * @method soliditySha3\r\n * @return {Object} the sha3\r\n */\n\n\nvar soliditySha3 = function () {\n  /*jshint maxcomplexity:false */\n  var args = Array.prototype.slice.call(arguments);\n  var hexArgs = args.map(_processSolidityEncodePackedArgs); // console.log(args, hexArgs);\n  // console.log('0x'+ hexArgs.join(''));\n\n  return utils.sha3('0x' + hexArgs.join(''));\n};\n/**\r\n * Hashes solidity values to a sha3 hash using keccak 256 but does return the hash of value `null` instead of `null`\r\n *\r\n * @method soliditySha3Raw\r\n * @return {Object} the sha3\r\n */\n\n\nvar soliditySha3Raw = function () {\n  return utils.sha3Raw('0x' + Array.prototype.slice.call(arguments).map(_processSolidityEncodePackedArgs).join(''));\n};\n/**\r\n * Encode packed args to hex\r\n *\r\n * @method encodePacked\r\n * @return {String} the hex encoded arguments\r\n */\n\n\nvar encodePacked = function () {\n  /*jshint maxcomplexity:false */\n  var args = Array.prototype.slice.call(arguments);\n  var hexArgs = args.map(_processSolidityEncodePackedArgs);\n  return '0x' + hexArgs.join('').toLowerCase();\n};\n\nmodule.exports = {\n  soliditySha3: soliditySha3,\n  soliditySha3Raw: soliditySha3Raw,\n  encodePacked: encodePacked\n};","map":{"version":3,"sources":["E:/Freelancing/blockchain/time-warriors-mint-page/node_modules/web3-utils/lib/soliditySha3.js"],"names":["BN","require","utils","_elementaryName","name","startsWith","slice","_parseTypeN","type","typesize","exec","parseInt","_parseTypeNArray","arraySize","_parseNumber","arg","isHexStrict","replace","isBigNumber","toString","isBN","Error","_solidityPack","value","size","num","length","utf8ToHex","isAddress","leftPad","toLowerCase","rightPad","bitLength","lt","toTwos","_processSolidityEncodePackedArgs","Array","isArray","hexArg","hasOwnProperty","t","v","toHex","test","JSON","stringify","map","val","join","soliditySha3","args","prototype","call","arguments","hexArgs","sha3","soliditySha3Raw","sha3Raw","encodePacked","module","exports"],"mappings":"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","sourcesContent":["/*\r\n This file is part of web3.js.\r\n\r\n web3.js is free software: you can redistribute it and/or modify\r\n it under the terms of the GNU Lesser General Public License as published by\r\n the Free Software Foundation, either version 3 of the License, or\r\n (at your option) any later version.\r\n\r\n web3.js is distributed in the hope that it will be useful,\r\n but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n GNU Lesser General Public License for more details.\r\n\r\n You should have received a copy of the GNU Lesser General Public License\r\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\n/**\r\n * @file soliditySha3.js\r\n * @author Fabian Vogelsteller <fabian@ethereum.org>\r\n * @date 2017\r\n */\r\nvar BN = require('bn.js');\r\nvar utils = require('./utils.js');\r\nvar _elementaryName = function (name) {\r\n    /*jshint maxcomplexity:false */\r\n    if (name.startsWith('int[')) {\r\n        return 'int256' + name.slice(3);\r\n    }\r\n    else if (name === 'int') {\r\n        return 'int256';\r\n    }\r\n    else if (name.startsWith('uint[')) {\r\n        return 'uint256' + name.slice(4);\r\n    }\r\n    else if (name === 'uint') {\r\n        return 'uint256';\r\n    }\r\n    else if (name.startsWith('fixed[')) {\r\n        return 'fixed128x128' + name.slice(5);\r\n    }\r\n    else if (name === 'fixed') {\r\n        return 'fixed128x128';\r\n    }\r\n    else if (name.startsWith('ufixed[')) {\r\n        return 'ufixed128x128' + name.slice(6);\r\n    }\r\n    else if (name === 'ufixed') {\r\n        return 'ufixed128x128';\r\n    }\r\n    return name;\r\n};\r\n// Parse N from type<N>\r\nvar _parseTypeN = function (type) {\r\n    var typesize = /^\\D+(\\d+).*$/.exec(type);\r\n    return typesize ? parseInt(typesize[1], 10) : null;\r\n};\r\n// Parse N from type[<N>]\r\nvar _parseTypeNArray = function (type) {\r\n    var arraySize = /^\\D+\\d*\\[(\\d+)\\]$/.exec(type);\r\n    return arraySize ? parseInt(arraySize[1], 10) : null;\r\n};\r\nvar _parseNumber = function (arg) {\r\n    var type = typeof arg;\r\n    if (type === 'string') {\r\n        if (utils.isHexStrict(arg)) {\r\n            return new BN(arg.replace(/0x/i, ''), 16);\r\n        }\r\n        else {\r\n            return new BN(arg, 10);\r\n        }\r\n    }\r\n    else if (type === 'number') {\r\n        return new BN(arg);\r\n    }\r\n    else if (utils.isBigNumber(arg)) {\r\n        return new BN(arg.toString(10));\r\n    }\r\n    else if (utils.isBN(arg)) {\r\n        return arg;\r\n    }\r\n    else {\r\n        throw new Error(arg + ' is not a number');\r\n    }\r\n};\r\nvar _solidityPack = function (type, value, arraySize) {\r\n    /*jshint maxcomplexity:false */\r\n    var size, num;\r\n    type = _elementaryName(type);\r\n    if (type === 'bytes') {\r\n        if (value.replace(/^0x/i, '').length % 2 !== 0) {\r\n            throw new Error('Invalid bytes characters ' + value.length);\r\n        }\r\n        return value;\r\n    }\r\n    else if (type === 'string') {\r\n        return utils.utf8ToHex(value);\r\n    }\r\n    else if (type === 'bool') {\r\n        return value ? '01' : '00';\r\n    }\r\n    else if (type.startsWith('address')) {\r\n        if (arraySize) {\r\n            size = 64;\r\n        }\r\n        else {\r\n            size = 40;\r\n        }\r\n        if (!utils.isAddress(value)) {\r\n            throw new Error(value + ' is not a valid address, or the checksum is invalid.');\r\n        }\r\n        return utils.leftPad(value.toLowerCase(), size);\r\n    }\r\n    size = _parseTypeN(type);\r\n    if (type.startsWith('bytes')) {\r\n        if (!size) {\r\n            throw new Error('bytes[] not yet supported in solidity');\r\n        }\r\n        // must be 32 byte slices when in an array\r\n        if (arraySize) {\r\n            size = 32;\r\n        }\r\n        if (size < 1 || size > 32 || size < value.replace(/^0x/i, '').length / 2) {\r\n            throw new Error('Invalid bytes' + size + ' for ' + value);\r\n        }\r\n        return utils.rightPad(value, size * 2);\r\n    }\r\n    else if (type.startsWith('uint')) {\r\n        if ((size % 8) || (size < 8) || (size > 256)) {\r\n            throw new Error('Invalid uint' + size + ' size');\r\n        }\r\n        num = _parseNumber(value);\r\n        if (num.bitLength() > size) {\r\n            throw new Error('Supplied uint exceeds width: ' + size + ' vs ' + num.bitLength());\r\n        }\r\n        if (num.lt(new BN(0))) {\r\n            throw new Error('Supplied uint ' + num.toString() + ' is negative');\r\n        }\r\n        return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\r\n    }\r\n    else if (type.startsWith('int')) {\r\n        if ((size % 8) || (size < 8) || (size > 256)) {\r\n            throw new Error('Invalid int' + size + ' size');\r\n        }\r\n        num = _parseNumber(value);\r\n        if (num.bitLength() > size) {\r\n            throw new Error('Supplied int exceeds width: ' + size + ' vs ' + num.bitLength());\r\n        }\r\n        if (num.lt(new BN(0))) {\r\n            return num.toTwos(size).toString('hex');\r\n        }\r\n        else {\r\n            return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\r\n        }\r\n    }\r\n    else {\r\n        // FIXME: support all other types\r\n        throw new Error('Unsupported or invalid type: ' + type);\r\n    }\r\n};\r\nvar _processSolidityEncodePackedArgs = function (arg) {\r\n    /*jshint maxcomplexity:false */\r\n    if (Array.isArray(arg)) {\r\n        throw new Error('Autodetection of array types is not supported.');\r\n    }\r\n    var type, value = '';\r\n    var hexArg, arraySize;\r\n    // if type is given\r\n    if (!!arg && typeof arg === 'object' && (arg.hasOwnProperty('v') || arg.hasOwnProperty('t') || arg.hasOwnProperty('value') || arg.hasOwnProperty('type'))) {\r\n        type = arg.hasOwnProperty('t') ? arg.t : arg.type;\r\n        value = arg.hasOwnProperty('v') ? arg.v : arg.value;\r\n        // otherwise try to guess the type\r\n    }\r\n    else {\r\n        type = utils.toHex(arg, true);\r\n        value = utils.toHex(arg);\r\n        if (!type.startsWith('int') && !type.startsWith('uint')) {\r\n            type = 'bytes';\r\n        }\r\n    }\r\n    if ((type.startsWith('int') || type.startsWith('uint')) && typeof value === 'string' && !/^(-)?0x/i.test(value)) {\r\n        value = new BN(value);\r\n    }\r\n    // get the array size\r\n    if (Array.isArray(value)) {\r\n        arraySize = _parseTypeNArray(type);\r\n        if (arraySize && value.length !== arraySize) {\r\n            throw new Error(type + ' is not matching the given array ' + JSON.stringify(value));\r\n        }\r\n        else {\r\n            arraySize = value.length;\r\n        }\r\n    }\r\n    if (Array.isArray(value)) {\r\n        hexArg = value.map(function (val) {\r\n            return _solidityPack(type, val, arraySize).toString('hex').replace('0x', '');\r\n        });\r\n        return hexArg.join('');\r\n    }\r\n    else {\r\n        hexArg = _solidityPack(type, value, arraySize);\r\n        return hexArg.toString('hex').replace('0x', '');\r\n    }\r\n};\r\n/**\r\n * Hashes solidity values to a sha3 hash using keccak 256\r\n *\r\n * @method soliditySha3\r\n * @return {Object} the sha3\r\n */\r\nvar soliditySha3 = function () {\r\n    /*jshint maxcomplexity:false */\r\n    var args = Array.prototype.slice.call(arguments);\r\n    var hexArgs = args.map(_processSolidityEncodePackedArgs);\r\n    // console.log(args, hexArgs);\r\n    // console.log('0x'+ hexArgs.join(''));\r\n    return utils.sha3('0x' + hexArgs.join(''));\r\n};\r\n/**\r\n * Hashes solidity values to a sha3 hash using keccak 256 but does return the hash of value `null` instead of `null`\r\n *\r\n * @method soliditySha3Raw\r\n * @return {Object} the sha3\r\n */\r\nvar soliditySha3Raw = function () {\r\n    return utils.sha3Raw('0x' + Array.prototype.slice.call(arguments).map(_processSolidityEncodePackedArgs).join(''));\r\n};\r\n/**\r\n * Encode packed args to hex\r\n *\r\n * @method encodePacked\r\n * @return {String} the hex encoded arguments\r\n */\r\nvar encodePacked = function () {\r\n    /*jshint maxcomplexity:false */\r\n    var args = Array.prototype.slice.call(arguments);\r\n    var hexArgs = args.map(_processSolidityEncodePackedArgs);\r\n    return '0x' + hexArgs.join('').toLowerCase();\r\n};\r\nmodule.exports = {\r\n    soliditySha3: soliditySha3,\r\n    soliditySha3Raw: soliditySha3Raw,\r\n    encodePacked: encodePacked\r\n};\r\n"]},"metadata":{},"sourceType":"script"}